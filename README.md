# GNSS数据分析工具

## 项目简介

GNSS数据分析工具是一个基于Web的GNSS（全球卫星导航系统）定位数据分析工具，专门用于处理和分析GPS、北斗等卫星导航系统的定位数据。该工具提供了直观的数据处理、分析和可视化功能。

## 主要功能

### 📁 文件处理
- **Excel文件读取**：支持读取`.xlsx`和`.xls`格式的Excel文件
- **智能表格检测**：自动检测包含定位数据的表格，无需手动指定
- **多种列名支持**：支持多种常见的列名格式（中文、英文）

### 🗺️ 数据解析
- **智能坐标解析**：自动识别和转换不同的经纬度格式
  - 小数度格式：如116.23
  - 度分格式：如11613.799520（自动转换为116.229992）
- **时间格式处理**：支持多种时间格式的解析
- **高程数据处理**：支持高程/海拔数据的读取和计算

### 📊 距离计算
- **3D距离计算**：使用Haversine公式计算包含高程差的三维距离
- **基准点设置**：用户可自定义基准点的经纬度和高程
- **批量计算**：一次性计算所有数据点到基准点的距离

### 📊 数据分析
- **基础统计**：
  - 平均误差
  - 最大误差
  - 最小误差
  - 数据点数量
  - 时间范围
- **CEP95精度**：计算95%分位数精度指标
- **时间范围筛选**：可设定特定时间范围进行统计分析
- **特殊时间段分析**：
  - 2-3分钟时间段
  - 6-7分钟时间段
  - 不同时间段的数据对比
- **📈 图表展示**：
  - 误差变化趋势图表
  - Y轴采用对数坐标，便于观察小误差变化
  - 纵坐标范围0.1-100米，最大值100米
  - 横坐标显示数据序号（秒）（1, 2, 3...）
  - 红色虚线显示30米误差限值，便于评估精度
  - 鼠标悬停查看详细数据和具体数值

### 📋 数据展示
- **表格显示**：完整的数据详情表格
- **智能隐藏**：自动隐藏连续的无效数据点（经纬度为0）
- **数据筛选**：支持显示/隐藏经纬度为0的数据行
- **行高亮**：不同时间段的数据使用不同颜色高亮显示
- **实时更新**：距离计算结果实时更新到表格中

### 📝 操作日志
- **实时日志**：记录所有操作步骤和结果
- **分类显示**：不同类型的消息使用不同颜色标识
- **自动滚动**：日志自动滚动到最新记录

## 技术特点

- **无需安装**：纯Web技术，开箱即用
- **离线运行**：支持本地文件协议运行，无需网络
- **响应式设计**：适配不同屏幕尺寸
- **错误处理**：完善的错误处理和用户提示
- **性能优化**：支持大文件处理（最大50MB）

## 使用方法

### 1. 准备数据文件
确保Excel文件包含以下列：
- **定位时间**：时间戳数据
- **经度**：经度坐标
- **纬度**：纬度坐标
- **高程**：海拔高度（可选）

### 2. 打开工具
直接用浏览器打开`GNSS__Analyzer.html`文件

### 3. 上传数据
- 点击文件选择器，选择您的Excel文件
- 工具会自动检测并读取数据

### 4. 设置基准点
在左侧面板中设置基准坐标：
- **基准经度**：目标位置的经度
- **基准纬度**：目标位置的纬度  
- **基准高程**：目标位置的高程（米）
- **起始时间**：数据记录的起始时间

### 5. 执行分析
点击"计算距离"按钮开始分析

### 6. 查看结果
- **统计结果**：在左侧面板查看各项统计指标
- **误差图表**：在右侧面板查看误差变化趋势图表
- **数据详情**：在下方表格中查看详细数据
- **操作日志**：在日志区域查看处理过程

## 数据格式要求

### Excel文件格式
支持以下列名格式：

| 功能 | 中文列名 | 英文列名 | 说明 |
|------|----------|----------|------|
| 时间 | 定位时间 | Time, timestamp | 必需 |
| 经度 | 经度 | Longitude, longitude, Lon | 必需 |
| 纬度 | 纬度 | Latitude, latitude, Lat | 必需 |
| 高程 | 高程、海拔 | Altitude, altitude, Elevation, elevation | 可选 |

### 经纬度格式
支持两种格式：
1. **小数度格式**：116.23（推荐）
2. **度分格式**：11613.799520（自动转换为116.229992）

## 界面说明

### 主要区域
1. **文件上传区**：位于页面顶部，用于选择Excel文件
2. **参数设置区**：设置基准坐标和起始时间
3. **统计结果区**：左侧面板显示分析结果
4. **数据表格区**：显示详细的数据列表
5. **操作日志区**：记录所有操作过程

### 操作按钮
- **计算距离**：执行距离计算和分析
- **显示经纬度为0的数据行**：切换无效数据行的显示状态

### 高亮说明
- **绿色高亮**：主要统计范围内的数据（5分15秒-5分45秒）
- **蓝色高亮**：特殊时间段数据（2-3分钟，6-7分钟）
- **省略号**：表示隐藏了连续的无效数据点

## 性能说明

- **支持文件大小**：最大50MB
- **推荐数据量**：少于10万行数据可获得最佳性能
- **浏览器要求**：现代浏览器，支持HTML5和ES6

## 故障排除

### 常见问题
1. **文件读取失败**：确保文件格式为Excel格式（.xlsx或.xs）
2. **数据为空**：检查列名是否正确，或尝试使用标准列名
3. **计算结果异常**：确认基准坐标和时间格式正确
4. **页面加载缓慢**：大文件处理需要时间，请耐心等待

### 日志查看
详细的错误信息会在操作日志中显示，请查看日志区域获取更多信息。

## 版本信息

- **当前版本**：1.0
- **更新时间**：2025年
- **兼容性**：支持所有现代浏览器

## 技术支持

如遇到问题，请检查：
1. Excel文件格式是否正确
2. 必需列是否完整
3. 数据格式是否符合要求
4. 浏览器控制台是否有错误信息

---

**注意**：本工具为GNSS数据分析专用工具，请确保输入数据的准确性和有效性。